<html>

<head>
<meta http-equiv="Content-Language" content="fr">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Comment obtenir de meilleures images</title>
<style>
<!--
.Standard    { text-align: justify; margin-left: 5; margin-right: 10 }
-->
</style>
</head>

<body>

<p><b><font face="Arial" size="5">La théorie<br>
</font><font face="Arial" size="4">ou comment obtenir de meilleures images</font></b></p>
<blockquote>

<p><b><font face="Arial"><A href="#WhyCombine">A quoi ça sert de combiner les 
images ?</a><br>
<A href="#CombineHowMany">Combien faut-il combiner d'images ?</a><br>
<A href="#Calibration">La calibration : comment utiliser les darks, flats et 
offsets</a></font></b><br>
<b><font face="Arial"><A href="#ISOSpeed">Quelle sensibilité ISO ?</a><br>
<A href="#CalibrationProcess">Le processus de calibration</a></font></b></p>
</blockquote>
<p>
<hr color="#0000ff"></p>
<p align="justify"><font face="Arial"><b><font size="4" color="#ff0000"><a name="WhyCombine">
</a>A quoi ça sert de 
combiner des images ?</font><font size="2"><br>
La réponse est simple : uniquement à augmenter le rapport signal/bruit.</font><br>
</b><font size="2">Est ce que les images obtenues sont plus lumineuses ? Non.<br>
Est ce que les images obtenues sont plus colorées ? Non.<br>
<br>
L'objectif de la combinaison de plusieurs images en une seule est uniquement 
d'augmenter le rapport signal/bruit. Les images obtenues sont ni plus lumineuses, 
ni plus colorées mais par contre elles ont beaucoup moins de bruit ce qui permet 
de pousser beaucoup plus le traitement et donc de faire ressortir beaucoup mieux 
les détails et les couleurs.</font></font></p>
<table border="0" cellspacing="1" width="100%" id="AutoNumber1">
  <tr>
    <td width="38%" valign="top">
    <p style="MARGIN-RIGHT: 10px" class="Standard"><font face="Arial" size="2">L'exemple ci contre montre le 
    résultat de l'empilement pour 1, 2, 4, 16 et 32 images.<br>
    <br>
    Aucune calibration n'a été effectuée, d'où les quelques pixels chauds qui 
    apparaissent dans certains cas (pas de soustraction d'offset ni de dark ni 
    d'utilisation de flat).<br>
    <br>
    Passer la souris sur le texte pour voir le résultat de l'empilement pour&nbsp; <br>
    <b>&nbsp;&nbsp;
    <A onmouseover = "document['STACKRESULT01'].src ='../images/Theory/Stack_1.jpg';;document.getElementById('LEGEND01').innerHTML='Image brute';" href="javascript:void(0);" > 1 image</a></b><br>
    <b>&nbsp;&nbsp;
    <A onmouseover = "document['STACKRESULT01'].src ='../images/Theory/Stack_2.jpg';document.getElementById('LEGEND01').innerHTML='Empilement de 2 images';" href="javascript:void(0);" > 2 images</a></b><br>
    <b>&nbsp;&nbsp;
    <A onmouseover = "document['STACKRESULT01'].src ='../images/Theory/Stack_4.jpg';;document.getElementById('LEGEND01').innerHTML='Empilement de 4 images';" href="javascript:void(0);" > 4 images</a></b><br>
    <b>&nbsp;&nbsp;
    <A onmouseover = "document['STACKRESULT01'].src ='../images/Theory/Stack_16.jpg';;document.getElementById('LEGEND01').innerHTML='Empilement de 16 images';" href="javascript:void(0);" > 16 images</a></b><br>
    <b>&nbsp;&nbsp;
    <A onmouseover = "document['STACKRESULT01'].src ='../images/Theory/Stack_32.jpg';;document.getElementById('LEGEND01').innerHTML='Empilement de 32 images';" href="javascript:void(0);" > 32 images</a></b></font></p>
    <p class="Standard"><font face="Arial" size="2">On constate que la luminosité et les couleurs de l'image ne 
    changent pas en fonction du nombre d'images empilées, mais que l'image 
    finale devient plus douce.</font></p>
    <p>&nbsp;</p></td>
    <td width="62%">
    <p align="center">
    <IMG id=STACKRESULT01 border = 0 name = STACKRESULT01 src="../images/Theory/Stack_1.jpg" width=591 height=591> <br><font face="Arial" size="2"><b name = "LEGEND01" id = "LEGEND01">Image brute</b></font></p></td>
  </tr>
</table>
<hr color="#0000ff">
<p align="justify"><b><font face="Arial" size="4" color="#ff0000"><a name="CombineHowMany"></a>Combien faut t-il combiner 
d'images</font></b><font face="Arial"><b><font size="4" color="#ff0000"> ?</font><font size="2"><br>
Le plus possible mais au delà d'un certain nombre c'est moins efficace.</font><br>
</b><font size="2">Le rapport signal/bruit s'améliore avec la racine carrée du 
nombre d'images combinées et ce indépendamment du temps de pose de chaque image.<br>
Ceci est vrai quelle que soit la méthode utilisée (moyenne, médiane, kappa-sigma 
clipping, moyenne pondérée auto adaptative...) à l'exception de la moyenne 
pondérée par l'entropie qui utilise l'entropie pour pondérer </font></font>
<font face="Arial" size="2">chaque pixel et ainsi augmente le bruit qui 
contribue beaucoup à l'entropie.</font></p>
<p align="justify"><font face="Arial" size="2">Cette règle signifie que si le rapport signal/bruit 
d'une image est de 1, en en combinant 10 le rapport signal/bruit du résultat est 
de 3.16 (racine carrée de 10). Pour 30 images le rapport signal/bruit passe à 
5.47, pour 50 images à 7.07, pour 100 images à 10 et pour 300 images à 17.32.<br>
<br>
On constate que pour gagner un facteur 7 il suffit de passer de 1 à 50 images, 
mais pour gagner le même facteur 7 au delà de 100 images il faut en ajouter 200 
de plus.</font></p>
<p align="justify"><font face="Arial" size="2"><b>Est ce que 100 x 1 minute est équivalent à 
10x10 minutes ?</b><br>
Oui en terme de rapport signal/bruit, mais non en terme de résultat.<br>
La différence entre une image de 10 minutes et une image de 1 minute est que le 
rapport signal/bruit de l'image de 10 minutes est 3.16 (racine carrée de 10) 
fois meilleur que le rapport signal/bruit de l'image de 1 minute.<br>
<br>
Comme vous pouvez le constater le rapport signal/bruit d'une image de 10 minutes 
est égal à celui de la combinaison de 10 images de 1 minute. De même, le rapport 
signal/bruit de la combinaison de 10 images de 10 minutes est égal à celui de la 
combinaison de 100 images de 1 minute.<br>
<br>
Toutefois ceci ne signifie pas que l'image est la même, juste que le rapport 
signal/bruit est le même. <br>
En fait vous n'obtiendrez pas le même signal (la 
partie intéressante) du tout. Pour faire simple vous n'obtiendrez un signal que 
si la plupart de vos images ont réussi à capter quelques photons correspondant 
au signal de façon à ce que le signal ne soit pas considéré comme du bruit.</font></p>
<p align="justify"><font face="Arial" size="2">Par exemple dans le cas d'une nébuleuse très 
faible, il est possible que seulement quelques photons arrivent en l'espace de 
10 minutes.<br>
Si vous utilisez des poses unitaires de 10 minutes vous aurez capturé des 
photons sur chacune des images et la combinaison fera ressortir clairement le 
signal.<br>
D'un autre coté si vous utilisez des poses unitaires de 1 minute la plupart de 
vos images ne montreront rien et sur les quelques images ayant capturé des 
photons ceux ci seront considérés comme du bruit et donc supprimés par la 
combinaison.</font></p>
<p align="justify"><font face="Arial" size="2"><b>Est ce que je peux combiner le résultat de 
deux combinaisons ?<br>
</b>Absolument, et la règle de la racine carrée s'applique également avec un 
petit bémol.<br>
<br>
En combinant deux images, le rapport signal/bruit augmente de 1.414 (racine 
carrée de 2).<br>
Si les deux images à combiner ont le même rapport signal/bruit cela est 
équivalent à faire un seul empilement. <br>
Si les deux images à combiner n'ont pas le même rapport signal/bruit la 
multiplication par 1.414 se fait sur le plus mauvais rapport signal/bruit.<br>
<br>
Ainsi, en combinant le résultat de 10x1 minutes avec une pose unitaire de 1 
minute on obtient à peu près le même rapport signal/bruit qu'en combinant 2 
images de 1 minute. Ceci est du au fait que le bruit s'additionne et que la 
meilleure image est abîmée par la plus mauvaise lors de la combinaison.</font></p>
<hr color="#0000ff" size="1">
<p align="justify"><b><font face="Arial" size="4" color="#ff0000"><a name="Calibration"></a>La calibration : comment 
utiliser les dark, flat, offset/bias<br>
</font></b><font face="Arial" size="2">La calibration est l'opération qui 
consiste à soustraire le signal d'offset, soustraire le signal de dark et 
diviser par le signal de flat.<br>
Il ne s'agit pas ici d'expliquer comment 
prendre des images dark, flat et offsets (voir
<A href="faq.htm#lightdarkflatoffset">ici</a> pour cette explication) mais de 
mieux comprendre comment il faut les utiliser pour obtenir les meilleures images 
possibles.</font></p>

<p align="justify"><font face="Arial" size="2"><b>Une bonne idée reçue</b><br>
Tout le monde dit qu'il faut prendre des images dark, flat et offsets pour 
obtenir les meilleures images possibles.<br>
<br>
Toutefois si certaines règles ne sont pas respectées l'utilisation de dark, 
flats et offsets peut dégrader considérablement la qualité des images brutes et 
aboutir à un résultat final décevant.<br>
<br>
La bonne nouvelle est qu'il est extrêmement facile d'obtenir de bon résultats en 
utilisant des darks, flats et offsets.<br>
<br>
<b>Une mauvaise idée reçue</b><br>
Il est absolument faux de dire que le nombre de dark, flat et offsets doit être 
proportionnel au nombre d'images brutes.<br>
De nombreuse personnes n'utilisent qu'un très petit nombre ou même une seule 
image dark, flat ou offset alors qu'elles pourraient obtenir de bien meilleurs 
résultats en utilisant un nombre important de dark, flat et offset à partir des 
mêmes images brutes.</font></p>

<p align="justify"><font face="Arial" size="2">En utilisant la règle de la racine carrée, les 
images maîtres (résultat de la combinaison des darks, flats et offsets) sont 
bien plus propres si un grand nombre d'images est utilisé pour les créer.<br>
Il faut se souvenir que ces images maîtres permettent d'enlever le signal dark/offset 
et corriger la planéité (flat) et non pas ajouter le bruit qui va avec.<br>
<br>
Il est important de noter qu'en soustrayant le maître dark&nbsp; d'une image 
brute, le signal dark est bien soustrait mais le bruit est <u><b>ajouté</b></u>.<br>
Donc moins l'image maître contient de bruit, plus l'image obtenue par la 
calibration est propre.<br>
<br>
De fait en utilisant un très petit nombre d'images pour créer les images maîtres 
on peut tripler le bruit de l'image calibrée par rapport à l'image non calibrée. 
Ensuite pour rattraper cette dégradation du rapport signal/bruit il faudra 
empiler 9 fois plus d'images brutes (3 au carré).</font></p>

<table border="0" cellspacing="1" width="100%" id="AutoNumber2">
  <tr>
    <td width="38%" valign="top">
    <p class="Standard"><font face="Arial" size="2">L'exemple ci contre montre le résultat 
    de l'empilement de (passer la 
souris au dessus du texte)<br>
    <br>
    <A onmouseover = "document['STACKRESULT02'].src ='../images/Theory/NoCalibration.jpg';;document.getElementById('LEGEND02').innerHTML='Empilement de 32 images brutes sans calibration';" href="javascript:void(0);" > 32 images brutes sans calibration</a></B><br>
    <br>
    <A onmouseover = "document['STACKRESULT02'].src ='../images/Theory/Calibration2.jpg';;document.getElementById('LEGEND02').innerHTML='Empilement de 32 images brutes calibrées avec 2 darks, 2 flats et 2 offsets';" href="javascript:void(0);" > 32 images brutes calibrées avec 2 darks, 2 flats et 2 offsets</a></B><br>
    <br>
    <A onmouseover = "document['STACKRESULT02'].src ='../images/Theory/Calibration20.jpg';;document.getElementById('LEGEND02').innerHTML='Empilement de 32 images brutes calibrées avec 20 darks, 20 flats et 20 offsets';" href="javascript:void(0);" > 32 images brutes calibrées avec 20 darks, 20 flats et 20 offsets</a></B><br>
<br>
    On peut constater  que la calibration avec plus de darks, flats et 
    offsets améliore l'image en faisant ressortir les détails et en réduisant le rapport signal/bruit.</font></p></td>
    <td width="50%">
    <p align="center">
    <IMG id=STACKRESULT02 border = 0 name = STACKRESULT02 src="../images/Theory/NoCalibration.jpg" width=591 height=591><br>
    <font face="Arial" size="2"><b name = "LEGEND02" id = "LEGEND02">Empilement 
    de 32 images brutes sans calibration</b></font></p></td>
  </tr>
</table>

<p align="justify"><font face="Arial" size="2">C'est la raison pour laquelle il faut utiliser le 
plus possible de dark, flat et offsets.<br>
D'un point de vue pratique une vingtaine d'images pour créer chaque image maître 
est un minimum si vous ne voulez pas ajouter trop de bruit et entre 50 et 100 
images permet d'obtenir des images maître très propres.<br>
<br>
<b>Aparté sur les pixels chauds</b><br>
Les pixels chauds sont des pixels qui se comportent de façon anormale.<br>
Ils représentent un signal très fort qui est visible sur toutes les images et 
sur tous les darks.<br>
<br>
Bien entendu si vous soustrayez une seule image dark de vos images brutes les 
pixels chauds disparaîtront ce qui vous donnera l'impression (fausse) que le 
dark a fait son boulot.<br>
Dans le même temps vous avez totalement ruiné l'image brute en doublant son 
bruit.</font></p>

<p><font face="Arial" size="2">
<br>
&nbsp;</font></p>

<hr color="#0000ff" SIZE="1">

<p align="justify"><font face="Arial" size="2"><a name="ISOSpeed"></a></font><b>
<font face="Arial" size="4" color="#ff0000">Quelle sensibilité ISO ?</font></b><font face="Arial" color="#ff0000" size="4"><b><br>
</b></font><font face="Arial" size="2">La question est classique est la réponse 
est simple : ce n'a pas d'importance...en quelque sorte.<br>
<br>
En fait la sensibilité ISO est juste un réglage de l'APN, et puisque le capteur 
CMOS ou CCD est le même (vous ne l'avez pas changé en changeant la sensibilité 
ISO) les résultats sont en réalité les mêmes.<br>
Ce n'est pas parce que vous allez utiliser une sensibilité ISO supérieure que 
vous allez capturer plus de photons. C'est juste que le signal (et le bruit) 
seront plus amplifiés.</font></p>
<p align="justify"><font face="Arial" size="2">La bonne nouvelle est que vous 
n'avez pas besoin de changer de sensibilité ISO pour essayer de capturer un 
objet plus faible. Vous avez juste besoin de faire des poses plus longues.<br>
<br>
Bien sur c'est un tout petit peu plus compliqué que cela, car il existe 
effectivement une bonne sensibilité ISO pour chaque appareil photo numérique.<br>
Toutefois elle dépend des caractéristiques de chaque capteur et de 
l'électronique associée (bruit de lecture et bruit talon) et n'est pas simple à 
déterminer.<br>
Christian Buil a calculé ces valeurs pour quelques appareils numériques Canon</font></p>
<table border="1" cellspacing="1" width="43%" id="AutoNumber3">
  <tr>
    <td width="35%"><b><font face="Arial" size="2">APN</font></b></td>
    <td width="65%"><b><font face="Arial" size="2">Sensibilité recommandée 
    (Optimale)</font></b></td>
  </tr>
  <tr>
    <td width="35%"><font face="Arial" size="2">Canon EOS 10D&nbsp;&nbsp;&nbsp;
    </font></td>
    <td width="65%" align="right"><font face="Arial" size="2">400&nbsp;&nbsp;&nbsp; 
    (290)</font></td>
  </tr>
  <tr>
    <td width="35%"><font face="Arial" size="2">Canon EOS 20D</font></td>
    <td width="65%" align="right"><font face="Arial" size="2">1000&nbsp; (1000)</font></td>
  </tr>
  <tr>
    <td width="35%"><font face="Arial" size="2">Canon EOS 350D</font></td>
    <td width="65%" align="right"><font face="Arial" size="2">800&nbsp;&nbsp;&nbsp; 
    (900)</font></td>
  </tr>
  <tr>
    <td width="35%"><font face="Arial" size="2">Canon EOS 5D</font></td>
    <td width="65%" align="right"><font face="Arial" size="2">1000&nbsp; (1100)</font></td>
  </tr>
</table>
<p>&nbsp;</p>

<hr color="#0000ff" SIZE="1">

<p align="justify"><b><font face="Arial" size="4" color="#ff0000">
<a name="CalibrationProcess"></a>La calibration</font></b><font face="Arial" color="#ff0000" size="4"><b><br>
</b></font><font face="Arial" size="2">Le processus de calibration et comment 
chaque images est utilisé (brutes, darks, flats...) est souvent perçu comme un 
mystère alors qu'il est relativement simple.<br>
<br>
Ci-dessous le schéma expliquant le processus de calibration complète lorsque 
tous les types de fichiers sont disponibles)</font></p>

<p align="left"><font face="Arial" size="4"><b>Calibration complète (tous les 
types de fichiers sont disponibles)</b></font><font face="Arial" size="2"><br>
<br>
<IMG border=0 src="../images/english/Calibration_Full.jpg" width=918 height=456></font></p>

<p align="justify"><font face="Arial" size="2"><br>
Toutefois il est courant et parfaitement possible de calibrer sans utiliser de 
dark flat. Dans ce cas le processus est décrit ci-dessous:</font></p>

<p align="justify"><font face="Arial" size="4"><b>Calibration alternative I (sans dark flat)</b></font><font face="Arial" size="2"><br>
<br>
<IMG border=0 src="../images/english/Calibration_Alternate1.jpg" width=918 height=454></font></p>

<p align="justify"><font face="Arial" size="2">Enfin, si vous utilisez des dark 
flat, vous pouvez parfaitement calibrer sans utiliser de bias/offset. Dans ce 
cas le processus est décrit ci-dessous:</font></p>

<p align="justify"><font face="Arial" size="4"><b>Calibration alternative II 
(sans bias/offset)</b></font><font face="Arial" size="2"><br>
<br>
<IMG border=0 src="../images/english/Calibration_Alternate2.jpg" width=918 height=454></font></p>

<p align="justify"><font face="Arial" size="2">Tout autre combinaison mène à une 
calibration imparfaite et pour obtenir les meilleures images il est impératif 
d'utiliser une de ces trois possibilités.</font></p>

<p><font face="Arial"><b><font size="4" color="#ff0000"><br>
&nbsp;</font></b></font></p>

</body>

</html>